<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Birthday</title>

  <meta name="description" content="A tiny birthday surprise made with love â¤ï¸">
  <meta name="author" content="Pouya">

  <style>
    :root{
      --pink:#ff3c83;
      --deep:#a6004c;
      --bg1:#ffd6e7;
      --bg2:#fff;
      --card: rgba(255,255,255,0.55);
      --shadow: 0 18px 55px rgba(0,0,0,0.12);
      --border: rgba(255,255,255,0.55);
      --msgbg: rgba(255,255,255,0.55);
      --msgtext: var(--deep);
      --sub: rgba(65,0,25,0.75);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      height:100vh;
      overflow:hidden;
      background: radial-gradient(1200px 600px at 50% 10%, #fff 0%, var(--bg1) 55%, #ffc1da 100%);
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
      transition: background 900ms ease;
    }

    /* Night mode */
    body.night{
      background: radial-gradient(1100px 700px at 50% 10%, rgba(255,255,255,0.08) 0%, rgba(34, 8, 20, 0.92) 55%, rgba(10, 0, 8, 0.98) 100%);
    }
    body.night .card{
      background: rgba(20, 6, 14, 0.55);
      border: 1px solid rgba(255,255,255,0.12);
      box-shadow: 0 22px 70px rgba(0,0,0,0.45);
    }
    body.night .title{
      color: #ff69a8;
      text-shadow: 0 10px 40px rgba(255, 105, 168, 0.28);
    }
    body.night .subtitle{
      color: rgba(255,255,255,0.78);
    }
    body.night #msg{
      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.14);
      color: rgba(255,255,255,0.90);
    }
    body.night .hint{
      color: rgba(255,255,255,0.55);
    }

    /* Confetti canvas */
    #confetti {
      position:fixed;
      inset:0;
      z-index:2;
      pointer-events:none;
    }

    /* Floating layer */
    #floatLayer{
      position:fixed;
      inset:0;
      z-index:1;
      pointer-events:none;
      overflow:hidden;
    }

    /* Card */
    .card{
      position:relative;
      z-index:3;
      width:min(560px, 100%);
      background: var(--card);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      border-radius: 24px;
      padding: 26px 18px 20px;
      text-align:center;
      transition: background 900ms ease, box-shadow 900ms ease, border-color 900ms ease;
    }

    .title{
      margin: 6px 0 14px;
      font-weight: 800;
      letter-spacing: -0.5px;
      color: var(--pink);
      line-height:1.15;
      font-size: clamp(26px, 6.2vw, 42px);
      text-shadow: 0 8px 30px rgba(255,60,131,0.22);
      transition: color 900ms ease, text-shadow 900ms ease;
    }

    .subtitle{
      margin: 0 0 16px;
      color: var(--sub);
      font-size: clamp(13px, 3.6vw, 16px);
      transition: color 900ms ease;
    }

    .btnRow{
      display:flex;
      gap:12px;
      justify-content:center;
      flex-wrap:wrap;
      margin-top: 10px;
    }

    button{
      border:none;
      cursor:pointer;
      border-radius: 16px;
      padding: 12px 18px;
      font-size: clamp(15px, 4vw, 18px);
      font-weight: 700;
      transition: transform .15s ease, filter .15s ease, box-shadow .15s ease;
      box-shadow: 0 10px 30px rgba(0,0,0,0.10);
      min-width: 150px;
      touch-action: manipulation;
    }
    button:active{ transform: scale(0.98); }
    button:hover{ filter: brightness(1.03); transform: translateY(-1px); }

    #btn1{ background: #ff4081; color:#fff; }
    #btn2{ background: #ff9e43; color:#fff; }

    #msg{
      margin-top: 14px;
      padding: 12px 12px;
      border-radius: 16px;
background: rgba(255,255,255,0.55);
      border: 1px solid rgba(255,255,255,0.6);
      color: var(--deep);
      font-size: clamp(16px, 4.2vw, 20px);
      line-height: 1.65;
      min-height: 72px;
      text-align: right;
      direction: rtl;
      transition: background 900ms ease, color 900ms ease, border-color 900ms ease;
      word-break: break-word;
    }

    .hint{
      margin-top: 10px;
      font-size: 12px;
      color: rgba(80,0,30,0.55);
      transition: color 900ms ease;
    }

    /* Highlight pulse */
    .pulse {
      display: inline-block;
      font-weight: 800;
      animation: pulse 1.25s ease-in-out infinite;
      text-shadow: 0 8px 22px rgba(255, 60, 131, 0.28);
    }
    body.night .pulse{
      text-shadow: 0 10px 30px rgba(255, 105, 168, 0.25);
    }

    @keyframes pulse{
      0%   { transform: scale(1);   filter: brightness(1); }
      50%  { transform: scale(1.03); filter: brightness(1.12); }
      100% { transform: scale(1);   filter: brightness(1); }
    }

    /* Floating objects â€“ smoother with sway */
    .float{
      position:absolute;
      bottom:-80px;
      will-change: transform, opacity;
      opacity: 0.92;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,0.08));
      animation:
        rise var(--dur) linear var(--delay) forwards,
        sway var(--swayDur) ease-in-out var(--delay) infinite;
    }

    @keyframes rise{
      0%   { transform: translate3d(var(--x), 0, 0) rotate(var(--rot)); opacity:0; }
      10%  { opacity: .95; }
      100% { transform: translate3d(var(--x), -120vh, 0) rotate(calc(var(--rot) + 18deg)); opacity:0; }
    }

    @keyframes sway{
      0%   { margin-left: 0px; }
      50%  { margin-left: var(--sway); }
      100% { margin-left: 0px; }
    }

    /* Mobile polish */
    @media (max-width: 420px){
      .card{ padding: 22px 14px 16px; border-radius: 22px; }
      button{ min-width: 140px; padding: 12px 16px; border-radius: 16px; }
      #msg{ padding: 12px 10px; }
    }
  </style>
</head>

<body>
  <canvas id="confetti"></canvas>
  <div id="floatLayer"></div>

  <div class="card">
    <div class="title">happy birthday babaiii â¤ï¸</div>
    <div class="subtitle">Ø¨Ø§ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ù¾ÛŒØ§Ù… Ø±Ùˆ Ø¹ÙˆØ¶ Ú©Ù† ğŸ˜Š</div>

    <div class="btnRow">
      <button id="btn1">Click me</button>
      <button id="btn2">ÙØ±Ø³ØªÙ†Ø¯Ù‡</button>
    </div>

    <div id="msg"></div>
    <div class="hint">Ø§Ú¯Ø± Ø¢Ù‡Ù†Ú¯ Ù¾Ø®Ø´ Ù†Ø´Ø¯ØŒ ÛŒÚ©Ø¨Ø§Ø± Ø±ÙˆÛŒ ØµÙØ­Ù‡/Ø¯Ú©Ù…Ù‡ Ø¨Ø²Ù† (Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ù…Ø±ÙˆØ±Ú¯Ø±Ù‡).</div>
  </div>

  <audio id="music" src="./donyaye-varoone.mp3" preload="auto"></audio>
  <script>
    // ---------------- Floating hearts & balloons (more + smoother) ----------------
    const floatLayer = document.getElementById("floatLayer");
    const icons = ["â¤ï¸","ğŸ’–","ğŸ’—","ğŸˆ","ğŸ€","ğŸ’","ğŸ’"];

    function spawnFloat() {
      const el = document.createElement("div");
      el.className = "float";
      el.textContent = icons[Math.floor(Math.random() * icons.length)];

      const size = 18 + Math.random() * 26;          // 18..44px
      const x = Math.random() * 100;                 // vw
      const dur = 7 + Math.random() * 7;             // 7..14s
      const delay = Math.random() * 0.8;             // 0..0.8s
      const rot = (-18 + Math.random() * 36);        // -18..18deg
      const sway = (Math.random() < 0.5 ? -1 : 1) * (10 + Math.random() * 24); // px
      const swayDur = 2.6 + Math.random() * 2.6;     // 2.6..5.2s

      el.style.left = x + "vw";
      el.style.fontSize = size + "px";
      el.style.setProperty("--x", "0px");
      el.style.setProperty("--dur", dur + "s");
      el.style.setProperty("--delay", delay + "s");
      el.style.setProperty("--rot", rot + "deg");
      el.style.setProperty("--sway", sway + "px");
      el.style.setProperty("--swayDur", swayDur + "s");

      floatLayer.appendChild(el);
      setTimeout(() => el.remove(), (dur + delay + 0.2) * 1000);
    }

    const isMobile = window.matchMedia("(max-width: 520px)").matches;
    const intervalMs = isMobile ? 180 : 140;
    setInterval(spawnFloat, intervalMs);
    for (let i=0;i<18;i++) setTimeout(spawnFloat, i*60);
// ---------------- Confetti (canvas) ----------------
    const canvas = document.getElementById("confetti");
    const ctx = canvas.getContext("2d");
    function resize() {
      canvas.width = window.innerWidth * devicePixelRatio;
      canvas.height = window.innerHeight * devicePixelRatio;
      canvas.style.width = window.innerWidth + "px";
      canvas.style.height = window.innerHeight + "px";
      ctx.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);
    }
    window.addEventListener("resize", resize);
    resize();

    const confetti = [];
    let confettiRunning = false;

    function addConfettiBurst(count = 160) {
      const originX = window.innerWidth * (0.35 + Math.random() * 0.3);
const originY = window.innerHeight * (0.15 + Math.random() * 0.2);
for (let i = 0; i < count; i++) {
  confetti.push({
    x: originX,
    y: originY,
    vx: (Math.random() - 0.5) * 10,
    vy: (Math.random() - 1.0) * 12,
    size: 3 + Math.random() * 5,
    rot: Math.random() * Math.PI,
    vr: (Math.random() - 0.5) * 0.25,
    life: 60 + Math.random() * 80,
    color: 'hsl(${Math.floor(Math.random() * 360)}, 85%, 60%)'
  });
}
if (!confettiRunning) {
  confettiRunning = true;
  requestAnimationFrame(tickConfetti);
}

    function tickConfetti() {
  ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);
      for (let i = confetti.length - 1; i >= 0; i--) {
        const p = confetti[i];
        p.vy += 0.22;
        p.vx *= 0.99;
        p.vy *= 0.99;

        p.x += p.vx;
        p.y += p.vy;
        p.rot += p.vr;
        p.life -= 1;

        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rot);
        ctx.fillStyle = p.color;
        ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size*1.4);
        ctx.restore();

        if (p.life <= 0 || p.y > window.innerHeight + 80) {
          confetti.splice(i, 1);
        }
      }

      if (confetti.length > 0) requestAnimationFrame(tickConfetti);
      else {
        confettiRunning = false;
        ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);
      }
    }

    setTimeout(() => addConfettiBurst(isMobile ? 110 : 150), 450);

    // ---------------- Helpers: typing + highlight ----------------
    const msg = document.getElementById("msg");

    function escapeHtml(str){
      return str
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    // Wrap target phrases with <span class="pulse"> ... </span>
    function highlightPhrases(rawText){
      const phrases = [
        "Ø®ÙÙ†â€ŒØªØ±ÛŒÙ† Ø¢Ø¯Ù…ÛŒ",
        "Ú©Ù„ÛŒ Ø¯ÙˆØ³ØªØªÙˆÙ† Ø¯Ø§Ø±Ù…",
        "Ø¯Ù„ÛŒÙ„ÛŒ Ù‡Ø³ØªÛŒÙ† Ú©Ù‡ Ø¨Ø§Ø¹Ø« Ù…ÛŒØ´Ù‡",
        "ØªÙˆÙ„Ø¯ØªÙ€Ù€ÙˆÙ† Ù…Ø¨Ø§Ø±Ú© Ø¨Ø§Ø¨Ø§ÛŒÛŒ Ù‚Ø´Ù†Ú¯ Ù…Ù†"
      ];

      // Build HTML safely by splitting on phrases
      let html = "";
      let i = 0;

      while (i < rawText.length) {
        let match = null;
        let matchIndex = -1;

        for (const p of phrases) {
          const idx = rawText.indexOf(p, i);
          if (idx !== -1 && (matchIndex === -1 || idx < matchIndex)) {
            matchIndex = idx;
            match = p;
          }
        }

        if (matchIndex === -1) {
          html += escapeHtml(rawText.slice(i));
          break;
        }

        html += escapeHtml(rawText.slice(i, matchIndex));
        html += '<span class="pulse">${escapeHtml(match)}</span>';
        i = matchIndex + match.length;
      }

      // Paragraph breaks
      html = html.replaceAll("\n\n", "<br><br>").replaceAll("\n", "<br>");
      return html;
    }

    let typingTimer = null;
    async function typeMessage(finalText, { speed = 22 } = {}) {
      // stop previous typing
      if (typingTimer) {
        clearInterval(typingTimer);
        typingTimer = null;
      }

      msg.innerHTML = "";
      msg.scrollTop = 0;

      let shown = "";
      let idx = 0;
return new Promise((resolve) => {
        typingTimer = setInterval(() => {
          idx++;
          shown = finalText.slice(0, idx);
          // During typing use plain text + line breaks (safe)
          msg.innerHTML = escapeHtml(shown).replaceAll("\n\n", "<br><br>").replaceAll("\n", "<br>");

          if (idx >= finalText.length) {
            clearInterval(typingTimer);
            typingTimer = null;
            // After typing, apply highlight pulses
            msg.innerHTML = highlightPhrases(finalText);
            resolve();
          }
        }, speed);
      });
    }

    // ---------------- Music + Night Mode ----------------
    const music = document.getElementById("music");
    let musicPlayed = false;

    async function playMusicOnce() {
      if (musicPlayed) return;
      try {
        music.volume = 0.85;
        await music.play();
        musicPlayed = true;

        // Night mode only when music actually starts
        document.body.classList.add("night");
      } catch (e) {
        // some browsers require extra tap; ignore
      }
    }

    function showLoveMessage() {
  return "Ø¢Ù‚Ø§ÛŒ Ù¾ÙˆÛŒØ§ÛŒ Ø¯ÙˆØ³Øªâ€ŒØ¯Ø§Ø´ØªÙ†ÛŒ Ù…Ù†ØŒ\n\n" +
  "Ø´Ù…Ø§ Ø®ÙÙ†â€ŒØªØ±ÛŒÙ† Ø¢Ø¯Ù…ÛŒ Ù‡Ø³ØªÛŒÙ† Ú©Ù‡ Ø¨Ù‡â€ŒÙ†Ø¸Ø±Ù… ØªÙˆÛŒ Ú©Ù„ Ø¯Ù†ÛŒØ§ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ù‡ Ùˆ Ù…Ù† Ú©Ù„ÛŒ Ø¯ÙˆØ³ØªØªÙˆÙ† Ø¯Ø§Ø±Ù… â¤ï¸\n\n" +
  "Ø´Ù…Ø§ Ø¯Ù„ÛŒÙ„ÛŒ Ù‡Ø³ØªÛŒÙ† Ú©Ù‡ Ø¨Ø§Ø¹Ø« Ù…ÛŒØ´Ù‡ Ø´Ø¨â€ŒÙ‡Ø§ Ø¨ØªÙˆÙ†Ù… Ø¢Ø±ÙˆÙ… Ø¨Ø®ÙˆØ§Ø¨Ù… Ùˆ ØµØ¨Ø­â€ŒÙ‡Ø§ Ø¨Ø§ Ø®ÙˆØ´Ø­Ø§Ù„ÛŒ Ø§Ø² Ø´Ù†ÛŒØ¯Ù† ØµØ¯Ø§ÛŒ Ø´Ù…Ø§ Ø¨ÛŒØ¯Ø§Ø± Ø¨Ø´Ù….\n\n" +
  "Ø¯ÙˆØ³Øª Ø¯Ø§Ø±Ù… Ú©Ù„ÛŒ Ú†ÛŒØ²Ø§ÛŒ Ù‚Ø´Ù†Ú¯ Ø±Ùˆ Ú©Ù†Ø§Ø± Ù‡Ù…Ø¯ÛŒÚ¯Ù‡ ØªØ¬Ø±Ø¨Ù‡ Ú©Ù†ÛŒÙ… Ùˆ Ø§Ù…ÛŒØ¯ÙˆØ§Ø±Ù… Ø¨ØªÙˆÙ†Ù… Ú©Ù„ÛŒÛŒÛŒÛŒ Ø§Ù†Ø±Ú˜ÛŒ Ø¨Ù‡ Ø´Ù…Ø§ Ø¨Ø¯Ù… Ùˆ Ø­Ø§Ù„ Ø¯Ù„ØªÙˆÙ† Ø±Ùˆ Ø¹Ø§Ù„ÛŒ Ù†Ú¯Ù‡ Ø¯Ø§Ø±Ù… âœ¨\n\n" +
  "ØªÙˆÙ„Ø¯ØªÙ€Ù€ÙˆÙ† Ù…Ø¨Ø§Ø±Ú© Ø¨Ø§Ø¨Ø§ÛŒÛŒ Ù‚Ø´Ù†Ú¯ Ù…Ù† â¤ï¸ğŸ‚";
}
// ---------------- Buttons ----------------
function showLoveMessage() {
  return "Ø¢Ù‚Ø§ÛŒ Ù¾ÙˆÛŒØ§ÛŒ Ø¯ÙˆØ³Øªâ€ŒØ¯Ø§Ø´ØªÙ†ÛŒ Ù…Ù†ØŒ\n\n" +
    "Ø´Ù…Ø§ Ø®ÙÙ†â€ŒØªØ±ÛŒÙ† Ø¢Ø¯Ù…ÛŒ Ù‡Ø³ØªÛŒÙ† Ú©Ù‡ Ø¨Ù‡â€ŒÙ†Ø¸Ø±Ù… ØªÙˆÛŒ Ú©Ù„ Ø¯Ù†ÛŒØ§ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ù‡ Ùˆ Ù…Ù† Ú©Ù„ÛŒ Ø¯ÙˆØ³ØªØªÙˆÙ† Ø¯Ø§Ø±Ù… â¤ï¸\n\n" +
    "Ø´Ù…Ø§ Ø¯Ù„ÛŒÙ„ÛŒ Ù‡Ø³ØªÛŒÙ† Ú©Ù‡ Ø¨Ø§Ø¹Ø« Ù…ÛŒØ´Ù‡ Ø´Ø¨â€ŒÙ‡Ø§ Ø¨ØªÙˆÙ†Ù… Ø¢Ø±ÙˆÙ… Ø¨Ø®ÙˆØ§Ø¨Ù… Ùˆ ØµØ¨Ø­â€ŒÙ‡Ø§ Ø¨Ø§ Ø®ÙˆØ´Ø­Ø§Ù„ÛŒ Ø§Ø² Ø´Ù†ÛŒØ¯Ù† ØµØ¯Ø§ÛŒ Ø´Ù…Ø§ Ø¨ÛŒØ¯Ø§Ø± Ø¨Ø´Ù….\n\n" +
    "Ø¯ÙˆØ³Øª Ø¯Ø§Ø±Ù… Ú©Ù„ÛŒ Ú†ÛŒØ²Ø§ÛŒ Ù‚Ø´Ù†Ú¯ Ø±Ùˆ Ú©Ù†Ø§Ø± Ù‡Ù…Ø¯ÛŒÚ¯Ù‡ ØªØ¬Ø±Ø¨Ù‡ Ú©Ù†ÛŒÙ… Ùˆ Ø§Ù…ÛŒØ¯ÙˆØ§Ø±Ù… Ø¨ØªÙˆÙ†Ù… Ú©Ù„ÛŒÛŒÛŒÛŒ Ø§Ù†Ø±Ú˜ÛŒ Ø¨Ù‡ Ø´Ù…Ø§ Ø¨Ø¯Ù… Ùˆ Ø­Ø§Ù„ Ø¯Ù„ØªÙˆÙ† Ø±Ùˆ Ø¹Ø§Ù„ÛŒ Ù†Ú¯Ù‡ Ø¯Ø§Ø±Ù… âœ¨\n\n" +
    "ØªÙˆÙ„Ø¯ØªÙ€Ù€ÙˆÙ† Ù…Ø¨Ø§Ø±Ú© Ø¨Ø§Ø¨Ø§ÛŒÛŒ Ù‚Ø´Ù†Ú¯ Ù…Ù† â¤ï¸ğŸ‚";
}

document.getElementById("btn1").addEventListener("click", async () => {
  addConfettiBurst(isMobile ? 180 : 260);
  await playMusicOnce();
  await typeMessage(showLoveMessage(), { speed: isMobile ? 24 : 18 });
});

document.getElementById("btn2").addEventListener("click", async () => {
  addConfettiBurst(isMobile ? 120 : 170);
  await typeMessage("Ù‚Ù„Ù…Ø¨Ù‡ ğŸ˜Œâœ¨", { speed: 26 });
});

<script>
  document.addEventListener(
    "pointerdown",
    () => {
      if (!musicPlayed) playMusicOnce();
    },
    { once: true }
  );
</script>
</body>
</html>








